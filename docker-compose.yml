services:
  lychee-ripe:
    build:
      context: .
      dockerfile: docker/Dockerfile
    ports:
      - "8000:8000"
    environment:
      - LYCHEE_MODEL_CONFIG=configs/model.yaml
      - LYCHEE_SERVICE_CONFIG=configs/service.yaml
    volumes:
      - ./weights:/app/weights

  gateway:
    build:
      context: .
      dockerfile: docker/Dockerfile.gateway
    ports:
      - "9000:9000"
    environment:
      - LYCHEE_GATEWAY_CONFIG=/etc/gateway/gateway.yaml
    volumes:
      - ./configs:/etc/gateway:ro
    depends_on:
      - lychee-ripe
